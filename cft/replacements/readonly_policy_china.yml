Version: 2012-10-17
Statement:
  - Sid: CloudGuardReadOnly
    Action:
      - 'fms:ListTagsForResource'
      - 'fms:GetAdminScope'
      - 'fms:GetPolicy'
      - 'fms:ListAdminAccountsForOrganization'
      - 'batch:DescribeJobQueues'
      - 'kinesisanalytics:ListTagsForResource'
      - 'airflow:GetEnvironment'
      - 'apigateway:GET'
      - 'athena:GetQueryExecution'
      - 'backup:ListTags'
      - 'codebuild:GetResourcePolicy'
      - 'compute-optimizer:GetRecommendationSummaries'
      - 'elasticfilesystem:Describe*'
      - 'glacier:ListTagsForVault'
      - 'glue:GetConnections'
      - 'glue:GetMLTransforms'
      - 'kinesis:List*'
      - 'kinesis:Describe*'
      - 'kinesisvideo:Describe*'
      - 'kinesisvideo:List*'
      - 'logs:Get*'
      - 'logs:FilterLogEvents'
      - 'logs:ListLogDeliveries'
      - 'codebuild:ListBuilds'
      - 'codebuild:BatchGetBuilds'
      - 'codepipeline:ListWebhooks'
      - 'memorydb:DescribeACLs'
      - 'memorydb:DescribeParameters'
      - 'memorydb:DescribeSnapshots'
      - 'memorydb:DescribeUsers'
      - 'memorydb:ListTags'
      - 'personalize:ListTagsForResource'
      - 's3:List*'
      - 'sns:ListPlatformApplications'
      - 'transcribe:Get*'
      - 'transcribe:List*'
      - 'translate:GetTerminology'
      - 'cloudformation:ListTypes'
      - 'cloudformation:DescribeType'
      - 'cloudformation:BatchDescribeTypeConfigurations'
      - 'serverlessrepo:GetApplication'
      - 'mediaconvert:ListJobs'
      - 'mediaconvert:ListPresets'
      - 'mediaconvert:ListQueues'
      - 'mediaconvert:ListTagsForResource'
      - 'signer:ListTagsForResource'
      - 'signer:ListSigningJobs'
      - 'signer:ListSigningPlatforms'
      - 'signer:ListSigningProfiles'
      - 'storagegateway:DescribeSMBFileShares'
      - 'ds:ListTagsForResource'
      - 'support:DescribeCases'
      - 'support:DescribeSeverityLevels'
      - 'waf-regional:ListLoggingConfigurations'
      - 'wafv2:GetIPSet'
      - 'lakeformation:GetDataLakeSettings'
      - 'sagemaker:DescribeTrainingJob'
      - 'sagemaker:ListTags'
      - 'sagemaker:DescribeNotebookInstance'
      - 'sagemaker:ListTrainingJobs'
      - 'sagemaker:ListNotebookInstances'
    Effect: Allow
    Resource: '*'
  - Sid: 'CloudGuardDeny'
    Effect: 'Deny'
    Action:
      - 'glacier:GetJobOutput'
      - 's3:GetObjectTorrent'
      - 'dynamodb:BatchGet*'
      - 'dynamodb:PartiQLSelect'
      - 'dynamodb:Query'
      - 'dynamodb:Scan'
      - 'dynamodb:Get*'
      - 'qldb:GetBlock'
      - 'qldb:GetDigest'
      - 'qldb:GetRevision'
      - 'sdb:Select*'
    Resource: '*'
  - Sid: 'CloudGuardDenyS3'
    Effect: 'Deny'
    Action:
      - 's3:GetObject'
    NotResource: !Sub arn:${AWS::Partition}:s3:::elasticbeanstalk-env-resources-??*?/*
  - REPLACEMENT_READONLY_POLICY_STATEMENTS
